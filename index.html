<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Ajoutez ces lignes dans la section <head> de votre document -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js">
  // R√©f√©rence vers la base de donn√©es Firebase (Realtime)
  let userRef = null;

  function registerPresence(pseudo) {
    const presenceRef = database.ref("presence");
    userRef = presenceRef.child(pseudo);

    // Enregistre que le joueur est connect√©
    userRef.set(true);
    userRef.onDisconnect().remove(); // Se retire automatiquement √† la d√©connexion

    // Affiche les utilisateurs connect√©s
    presenceRef.on("value", (snapshot) => {
      const users = snapshot.val() || {};
      const userList = Object.keys(users);
      const container = document.querySelector("#connected-users span");
      container.textContent = userList.length > 0 ? userList.join(", ") : "Aucun";
    });
  }
</script>

</script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>DeadHope - Terminal Avanc√©</title>
<style>
:root {
--bg: #0a0a0a;
--fg: #e0e0e0;
--accent: #8b0000;
--accent-glow: rgba(139, 0, 0, 0.7);
--danger: #e74c3c;
--terminal-green: #00ff00;
--card-bg: rgba(20, 20, 20, 0.8);
}

body {
margin: 0;
font-family: 'Courier New', monospace;
background-color: var(--bg);
color: var(--fg);
overflow-x: hidden;
position: relative;
}

body::before {
content: "";
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7));
z-index: -2;
pointer-events: none;
}

/* CRT Overlay effect */
body::after {
content: "";
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background: 
linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
background-size: 100% 2px, 3px 100%;
pointer-events: none;
z-index: 9999;
animation: flicker 0.15s infinite;
}

@keyframes flicker {
0% { opacity: 0.97; }
5% { opacity: 0.95; }
10% { opacity: 0.97; }
15% { opacity: 0.94; }
20% { opacity: 0.98; }
25% { opacity: 0.95; }
30% { opacity: 0.97; }
35% { opacity: 0.96; }
40% { opacity: 0.97; }
45% { opacity: 0.95; }
50% { opacity: 0.98; }
55% { opacity: 0.97; }
60% { opacity: 0.95; }
65% { opacity: 0.97; }
70% { opacity: 0.96; }
75% { opacity: 0.94; }
80% { opacity: 0.98; }
85% { opacity: 0.97; }
90% { opacity: 0.95; }
95% { opacity: 0.96; }
100% { opacity: 0.97; }
}

/* Scanline effect */
.scanline {
position: fixed;
top: 0; left: 0; right: 0;
height: 2px;
background: rgba(255, 255, 255, 0.1);
z-index: 9998;
animation: scanline 6s linear infinite;
pointer-events: none;
}

@keyframes scanline {
0% { top: 0%; }
100% { top: 100%; }
}

header {
padding: 1.5rem;
background: linear-gradient(135deg, rgba(20,20,20,0.8) 0%, rgba(80,0,0,0.5) 100%);
text-align: center;
border-bottom: 2px solid var(--accent);
box-shadow: 0 0 20px rgba(139, 0, 0, 0.5);
position: relative;
overflow: hidden;
}

.logo {
margin-bottom: 1rem;
position: relative;
display: inline-block;
}

.logo h1 {
font-family: 'Courier New', monospace;
font-size: 2.5rem;
text-transform: uppercase;
letter-spacing: 3px;
margin: 0;
padding: 10px 20px;
color: #fff;
background: rgba(139, 0, 0, 0.7);
border-radius: 6px;
position: relative;
text-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
box-shadow: 0 0 15px rgba(139, 0, 0, 0.5);
}

.logo-glow {
position: absolute;
top: 0; left: 0; right: 0; bottom: 0;
border-radius: 6px;
box-shadow: 0 0 15px var(--accent-glow);
animation: pulse 4s infinite alternate;
}

@keyframes pulse {
0% { opacity: 0.5; box-shadow: 0 0 15px var(--accent-glow); }
100% { opacity: 1; box-shadow: 0 0 30px var(--accent-glow); }
}

.info-bar {
display: flex;
justify-content: space-around;
align-items: center;
background: rgba(0, 0, 0, 0.5);
padding: 10px;
border-radius: 4px;
border: 1px solid #333;
margin-top: 1rem;
}

.info-item {
display: flex;
align-items: center;
gap: 10px;
}

.info-value {
font-family: monospace;
color: var(--terminal-green);
text-shadow: 0 0 5px rgba(0, 255, 0, 0.7);
}

nav {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
justify-content: center;
background: linear-gradient(90deg, rgba(10,10,10,0.8) 0%, rgba(30,30,30,0.8) 100%);
padding: 1rem;
border-bottom: 1px solid #333;
position: sticky;
top: 0;
z-index: 100;
}

nav a {
color: var(--fg);
text-decoration: none;
padding: 0.5rem 1rem;
background: linear-gradient(to bottom, #8b0000, #5a0000);
border-radius: 5px;
transition: all 0.3s ease;
border: 1px solid #aa0000;
font-weight: bold;
text-transform: uppercase;
letter-spacing: 1px;
position: relative;
overflow: hidden;
}

nav a::before {
content: "";
position: absolute;
top: -50%; left: -50%;
width: 200%; height: 200%;
background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
opacity: 0;
transition: opacity 0.3s;
}

nav a:hover {
box-shadow: 0 0 15px rgba(139, 0, 0, 0.7);
transform: translateY(-2px);
}

nav a:hover::before {
opacity: 1;
}

main {
max-width: 1200px;
margin: 0 auto;
padding: 1rem;
}

section {
margin-bottom: 3rem;
background: var(--card-bg);
padding: 1.5rem;
border-radius: 10px;
border: 1px solid #333;
box-shadow: 0 5px 15px rgba(0,0,0,0.5);
position: relative;
overflow: hidden;
}

section::before {
content: "";
position: absolute;
top: 0; left: 0; right: 0;
height: 3px;
background: linear-gradient(90deg, transparent, var(--accent), transparent);
}

h2 {
color: var(--accent);
font-family: monospace;
text-transform: uppercase;
letter-spacing: 2px;
border-bottom: 2px solid var(--accent);
padding-bottom: 0.5rem;
margin-top: 0;
display: flex;
align-items: center;
gap: 10px;
}

h2::before {
content: "‚ñ∂";
color: var(--terminal-green);
font-size: 0.8em;
}

button {
background: linear-gradient(to bottom, #333, #222);
color: #eee;
border: 1px solid #555;
padding: 8px 16px;
font-family: monospace;
cursor: pointer;
border-radius: 4px;
transition: all 0.3s;
display: inline-flex;
align-items: center;
gap: 8px;
}

button:hover {
background: linear-gradient(to bottom, #444, #333);
box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

input, select, textarea {
background-color: #111;
color: var(--terminal-green);
border: 1px solid #333;
padding: 8px;
font-family: monospace;
border-radius: 4px;
}

input:focus, select:focus, textarea:focus {
outline: none;
border-color: var(--accent);
box-shadow: 0 0 5px rgba(139, 0, 0, 0.5);
}

.character-wrapper {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
gap: 1.5rem;
margin-top: 1rem;
}

.character-card {
background: linear-gradient(135deg, rgba(30,30,30,0.8) 0%, rgba(20,20,20,0.9) 100%);
padding: 1.5rem;
border-radius: 8px;
border: 1px solid #333;
box-shadow: 0 5px 15px rgba(0,0,0,0.3);
display: flex;
flex-direction: column;
gap: 1rem;
position: relative;
overflow: hidden;
transition: transform 0.3s, box-shadow 0.3s;
}

.character-card:hover {
transform: translateY(-5px);
box-shadow: 0 10px 20px rgba(0,0,0,0.5);
}

.character-card h3 {
margin: 0;
color: var(--accent);
border-bottom: 1px solid #333;
padding-bottom: 0.5rem;
}

.character-card textarea {
resize: vertical;
min-height: 80px;
}

table {
width: 100%;
border-collapse: separate;
border-spacing: 0;
margin: 1rem 0;
}

th {
text-align: left;
background: linear-gradient(to bottom, #222, #111);
color: var(--accent);
padding: 10px;
text-transform: uppercase;
letter-spacing: 1px;
font-size: 0.9rem;
}

th:first-child {
border-top-left-radius: 6px;
}

th:last-child {
border-top-right-radius: 6px;
}

td {
padding: 10px;
border-bottom: 1px solid #333;
background: rgba(20, 20, 20, 0.5);
}

tr:hover td {
background: rgba(30, 30, 30, 0.7);
}

.danger-grid-wrapper {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
gap: 1rem;
}

.danger-zone-entry {
background: linear-gradient(135deg, rgba(30,10,10,0.8) 0%, rgba(10,10,10,0.9) 100%);
padding: 1rem;
border-radius: 6px;
border: 1px solid #333;
display: flex;
flex-direction: column;
gap: 0.8rem;
}

#chat-toggle {
position: fixed;
bottom: 20px;
right: 20px;
background: var(--accent);
width: 60px;
height: 60px;
border-radius: 50%;
display: flex;
justify-content: center;
align-items: center;
font-size: 24px;
color: white;
border: none;
box-shadow: 0 5px 15px rgba(0,0,0,0.3);
z-index: 1000;
cursor: pointer;
animation: pulse-chat 2s infinite alternate;
}

@keyframes pulse-chat {
0% { box-shadow: 0 0 10px rgba(139, 0, 0, 0.5); }
100% { box-shadow: 0 0 25px rgba(139, 0, 0, 0.8); }
}

#radio-chat {
position: fixed;
bottom: 90px;
right: 20px;
width: 350px;
background: rgba(10, 10, 10, 0.9);
padding: 15px;
border-radius: 8px;
border: 1px solid #444;
box-shadow: 0 10px 25px rgba(0,0,0,0.5);
z-index: 999;
animation: fadeIn 0.4s ease-out forwards;
}

#chat-log {
background: #1a1a1a;
padding: 15px;
max-height: 250px;
overflow-y: auto;
border-radius: 8px;
border: 1px solid #333;
margin-top: 10px;
font-family: monospace;
}

.chat-message {
margin-bottom: 10px;
animation: fadeIn 0.3s ease-out forwards;
}

@keyframes fadeIn {
from { opacity: 0; transform: translateY(10px); }
to { opacity: 1; transform: translateY(0); }
}

.typing-indicator {
display: inline-block;
animation: typeBlink 1s infinite;
}

@keyframes typeBlink {
0%, 100% { opacity: 1; }
50% { opacity: 0; }
}

#welcome-screen {
position: fixed;
top: 0; left: 0;
width: 100%; height: 100%;
background: #000;
z-index: 9999;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
}

/* Custom code to ensure the welcome screen has a proper background and truck */
.welcome-background {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: #000;
z-index: -1;
}

.welcome-grid {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: 
linear-gradient(rgba(0,20,0,0.1) 1px, transparent 1px),
linear-gradient(90deg, rgba(0,20,0,0.1) 1px, transparent 1px);
background-size: 20px 20px;
opacity: 0.2;
z-index: -1;
}

.truck-container {
position: absolute;
bottom: 10%;
left: 50%;
transform: translateX(-50%);
width: 300px;
height: 150px;
z-index: 1;
}

.truck {
position: relative;
width: 100%;
height: 100%;
}

.truck-body {
position: absolute;
bottom: 0;
width: 250px;
height: 60px;
background: #333;
border: 2px solid #444;
border-radius: 5px;
}

.truck-cab {
position: absolute;
bottom: 60px;
left: 20px;
width: 80px;
height: 50px;
background: #222;
border: 2px solid #444;
border-top-left-radius: 10px;
border-top-right-radius: 3px;
}

.truck-window {
position: absolute;
top: 10px;
left: 15px;
width: 50px;
height: 20px;
background: #111;
border: 1px solid #333;
}

.truck-wheel {
position: absolute;
bottom: -10px;
width: 30px;
height: 30px;
background: #111;
border: 2px solid #333;
border-radius: 50%;
}

.wheel-front {
left: 40px;
}

.wheel-back {
right: 40px;
}

.truck-light {
position: absolute;
bottom: 40px;
left: 10px;
width: 10px;
height: 5px;
background: #ff0;
border-radius: 50%;
animation: blink 1s infinite alternate;
}

@keyframes blink {
0% { opacity: 0.5; }
100% { opacity: 1; box-shadow: 0 0 10px #ff0; }
}

#welcome-title {
font-size: 3rem;
color: var(--terminal-green);
text-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
margin-bottom: 2rem;
letter-spacing: 3px;
position: relative;
}

#welcome-title::before,
#welcome-title::after {
content: "‚ò£Ô∏è";
margin: 0 15px;
}

#terminal-lines {
font-family: monospace;
color: var(--terminal-green);
background: rgba(0, 0, 0, 0.7);
padding: 20px;
border-radius: 8px;
width: 80%;
max-width: 700px;
margin-bottom: 2rem;
box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
border: 1px solid rgba(0, 255, 0, 0.3);
overflow: hidden;
}

#input-zone {
display: none;
text-align: center;
}

#input-pseudo {
background: rgba(0, 0, 0, 0.7);
border: 1px solid var(--terminal-green);
color: var(--terminal-green);
padding: 15px;
width: 300px;
font-size: 18px;
text-align: center;
margin-bottom: 1rem;
border-radius: 4px;
}

#start-button {
background: var(--accent);
color: white;
border: none;
padding: 15px 30px;
font-size: 18px;
border-radius: 4px;
cursor: pointer;
text-transform: uppercase;
letter-spacing: 2px;
transition: all 0.3s;
}

#start-button:hover {
background: #a00000;
box-shadow: 0 0 20px rgba(139, 0, 0, 0.5);
}

/* Visual elements and animations */
.visual-glitch {
position: absolute;
background: rgba(255, 0, 0, 0.1);
width: 100%;
height: 40px;
top: 0;
left: 0;
pointer-events: none;
opacity: 0;
animation: glitch-appear 15s infinite;
}

@keyframes glitch-appear {
0%, 95%, 100% { opacity: 0; transform: translateY(-100px); }
96%, 99% { opacity: 0.8; transform: translateY(var(--pos, 100px)); }
}

/* Custom map style instead of iframe */
.custom-map {
width: 100%;
height: 600px;
border-radius: 8px;
background-color: #1a1a1a;
position: relative;
overflow: hidden;
box-shadow: 0 5px 15px rgba(0,0,0,0.5);
}

.map-grid {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-image: 
linear-gradient(#222 1px, transparent 1px),
linear-gradient(90deg, #222 1px, transparent 1px);
background-size: 30px 30px;
z-index: 1;
}

.map-title {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
font-size: 3rem;
font-family: 'Courier New', monospace;
color: #ddd;
text-transform: uppercase;
letter-spacing: 3px;
z-index: 5;
text-align: center;
width: 100%;
}

.map-error {
position: absolute;
top: 40%;
left: 50%;
transform: translate(-50%, -50%);
padding: 15px 30px;
background: #8b0000;
color: white;
border-radius: 5px;
font-family: monospace;
font-weight: bold;
z-index: 10;
}

.map-message {
position: absolute;
top: 60%;
left: 50%;
transform: translate(-50%, -50%);
color: #aaa;
font-size: 0.9rem;
text-align: center;
max-width: 80%;
line-height: 1.5;
z-index: 10;
}

.map-warning {
position: absolute;
width: 50px;
height: 50px;
z-index: 10;
}

.warning-left {
top: 50%;
left: 10%;
transform: translateY(-50%);
}

.warning-right {
top: 50%;
right: 10%;
transform: translateY(-50%);
}

.warning-triangle {
width: 100%;
height: 100%;
background: transparent;
position: relative;
}

.warning-triangle::before {
content: "‚ö†Ô∏è";
font-size: 48px;
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
color: #3498db;
}

.map-location {
position: absolute;
width: 20px;
height: 20px;
background: transparent;
border-radius: 50%;
z-index: 5;
}

.location-1 {
top: 30%;
left: 20%;
background: #e74c3c;
box-shadow: 0 0 10px #e74c3c;
}

.location-2 {
top: 60%;
left: 70%;
background: #2ecc71;
box-shadow: 0 0 10px #2ecc71;
}

.location-3 {
top: 20%;
left: 80%;
background: #3498db;
box-shadow: 0 0 10px #3498db;
}

.location-4 {
top: 75%;
left: 35%;
background: #f1c40f;
box-shadow: 0 0 10px #f1c40f;
}

.location-pulse {
position: absolute;
width: 100%;
height: 100%;
border-radius: 50%;
animation: pulse-location 2s infinite;
}

@keyframes pulse-location {
0% { transform: scale(1); opacity: 1; }
100% { transform: scale(3); opacity: 0; }
}

.map-legend {
position: absolute;
top: 10px;
left: 10px;
background: rgba(0, 0, 0, 0.7);
padding: 15px;
border-radius: 5px;
border: 1px solid #333;
z-index: 10;
}

.legend-title {
color: #e74c3c;
margin-bottom: 10px;
font-weight: bold;
}

.legend-item {
margin-bottom: 5px;
display: flex;
align-items: center;
gap: 10px;
}

.legend-circle {
width: 12px;
height: 12px;
border-radius: 50%;
}

.stat-container {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 1.5rem;
margin: 2rem 0;
}

.stat-card {
background: rgba(20, 20, 20, 0.8);
border-radius: 8px;
padding: 1.5rem;
position: relative;
overflow: hidden;
border: 1px solid #333;
}

.stat-value {
font-size: 2.5rem;
color: var(--terminal-green);
margin: 0.5rem 0;
text-align: center;
text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
}

.stat-label {
text-align: center;
color: #aaa;
font-size: 0.9rem;
}

.progress-bar {
width: 100%;
height: 10px;
background: #222;
border-radius: 5px;
overflow: hidden;
margin-top: 1rem;
}

.progress-fill {
height: 100%;
background: linear-gradient(90deg, var(--accent), #ff5555);
width: var(--fill, 50%);
border-radius: 5px;
}

/* Mission countdown */
.countdown {
text-align: center;
margin: 1rem 0;
padding: 1rem;
background: rgba(139, 0, 0, 0.2);
border-radius: 8px;
position: relative;
}

.countdown-value {
font-size: 3rem;
font-family: monospace;
color: var(--accent);
text-shadow: 0 0 15px rgba(139, 0, 0, 0.7);
}

.countdown-label {
font-size: 0.9rem;
color: #aaa;
margin-top: 0.5rem;
}

/* Message notification */
.msg-notification {
position: absolute;
top: -8px;
right: -8px;
background: #ff3333;
color: white;
width: 20px;
height: 20px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-size: 12px;
font-weight: bold;
animation: pulse 2s infinite;
}

/* CIN√âMATIQUE STYLES - Version am√©lior√©e */
#cinematique-container {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.95);
z-index: 10000;
display: none;
flex-direction: column;
align-items: center;
justify-content: center;
opacity: 0;
transition: opacity 1s ease-in-out;
}

#cinematique-scene {
width: 90%;
max-width: 1000px;
height: 70vh;
position: relative;
overflow: hidden;
border: 1px solid #444;
box-shadow: 0 0 30px rgba(139, 0, 0, 0.5);
border-radius: 5px;
background: radial-gradient(circle at center, #0c0707 0%, #000000 100%);
}

/* D√©cor post-apocalyptique */
.ruined-building {
position: absolute;
bottom: 20%;
width: 120px;
height: 200px;
background: #111;
box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
z-index: 2;
}

.ruined-building-1 {
left: 10%;
transform: skewX(-5deg);
clip-path: polygon(0 20%, 100% 0, 100% 100%, 0 100%);
}

.ruined-building-2 {
right: 15%;
transform: skewX(3deg);
clip-path: polygon(0 0, 100% 15%, 100% 100%, 0 100%);
}

/* Survivant */
#cinematique-survivor {
position: absolute;
bottom: 30px;
left: 50%;
transform: translateX(-50%);
width: 300px;
height: 400px;
z-index: 10;
}

.survivor-silhouette {
position: absolute;
bottom: 0;
left: 50%;
transform: translateX(-50%);
width: 180px;
height: 350px;
display: flex;
flex-direction: column;
align-items: center;
}

.survivor-head {
position: relative;
width: 80px;
height: 100px;
z-index: 12;
}

.survivor-hood {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 90%;
background: #111;
border-radius: 50% 50% 40% 40% / 60% 60% 40% 40%;
overflow: hidden;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.8);
}

.survivor-face {
position: absolute;
top: 40%;
left: 50%;
transform: translateX(-50%);
width: 60%;
height: 30%;
background: #000;
border-radius: 50%;
overflow: hidden;
}

.eyes {
position: absolute;
top: 40%;
left: 0;
width: 100%;
height: 20%;
display: flex;
justify-content: space-around;
align-items: center;
}

.eye {
width: 10px;
height: 4px;
background: #8b0000;
border-radius: 50%;
box-shadow: 0 0 10px #ff0000;
animation: eyeGlow 3s infinite alternate;
}

@keyframes eyeGlow {
0% { opacity: 0.7; box-shadow: 0 0 5px #ff0000; }
100% { opacity: 1; box-shadow: 0 0 12px #ff0000; }
}

.survivor-body {
position: absolute;
bottom: 0;
left: 50%;
transform: translateX(-50%);
width: 120px;
height: 250px;
background: linear-gradient(to bottom, #222 0%, #111 100%);
border-radius: 30px 30px 0 0;
z-index: 11;
}

/* Feu de camp impressionnant */
.campfire {
position: absolute;
bottom: 20px;
left: 50%;
transform: translateX(-50%);
width: 120px;
height: 100px;
z-index: 9;
}

.fire {
position: relative;
width: 100%;
height: 100%;
}

.flames {
position: absolute;
bottom: 30px;
left: 50%;
transform: translateX(-50%);
width: 80px;
height: 80px;
z-index: 3;
}

.flame {
position: absolute;
bottom: 0;
left: 50%;
transform: translateX(-50%);
width: 40px;
height: 80px;
background: linear-gradient(to top, #ff4500, #ff8c00, transparent);
border-radius: 50% 50% 20% 20% / 60% 60% 40% 40%;
filter: blur(2px);
opacity: 0.9;
animation: flameMove 0.5s infinite alternate;
}

.flame:nth-child(2) {
left: 35%;
height: 70px;
width: 35px;
background: linear-gradient(to top, #ff8c00, #ffcc00, transparent);
animation-delay: 0.1s;
animation-duration: 0.6s;
}

.flame:nth-child(3) {
left: 65%;
height: 60px;
width: 30px;
background: linear-gradient(to top, #ffcc00, #ffdd00, transparent);
animation-delay: 0.2s;
animation-duration: 0.4s;
}

@keyframes flameMove {
0% { height: 70px; filter: blur(2px); }
100% { height: 90px; filter: blur(3px); }
}

.logs {
position: absolute;
bottom: 5px;
left: 50%;
transform: translateX(-50%);
width: 100px;
height: 30px;
z-index: 2;
}

.log {
position: absolute;
width: 60px;
height: 15px;
background: #3E2723;
border-radius: 5px;
}

.log-1 {
bottom: 5px;
left: 10px;
transform: rotate(-25deg);
}

.log-2 {
bottom: 5px;
right: 10px;
transform: rotate(25deg);
}

.log-3 {
bottom: 10px;
left: 30px;
transform: rotate(0deg);
}

.glow {
position: absolute;
bottom: 0;
left: 50%;
transform: translateX(-50%);
width: 120px;
height: 20px;
background: radial-gradient(ellipse, rgba(255, 100, 0, 0.4), transparent 70%);
border-radius: 50%;
filter: blur(8px);
z-index: 1;
animation: glowPulse 2s infinite alternate;
}

@keyframes glowPulse {
0% { opacity: 0.3; width: 100px; }
100% { opacity: 0.6; width: 140px; }
}

/* Effets de lumi√®re sur le survivant */
.fire-light {
position: absolute;
bottom: 50px;
left: 50%;
transform: translateX(-50%);
width: 300px;
height: 200px;
background: radial-gradient(ellipse at center, rgba(255, 69, 0, 0.2), transparent 70%);
z-index: 4;
pointer-events: none;
animation: fireLightFlicker 2s infinite alternate;
}

@keyframes fireLightFlicker {
0% { opacity: 0.3; }
100% { opacity: 0.5; }
}

/* √âmissions de braises et de fum√©e */
.embers {
position: absolute;
bottom: 50px;
left: 50%;
transform: translateX(-50%);
width: 60px;
height: 100px;
z-index: 5;
}

.ember {
position: absolute;
bottom: 0;
width: 4px;
height: 4px;
background: #ff7e00;
border-radius: 50%;
filter: blur(1px);
opacity: 0;
animation: emberRise 3s infinite;
}

.ember:nth-child(1) { left: 30%; animation-delay: 0s; }
.ember:nth-child(2) { left: 50%; animation-delay: 1s; }
.ember:nth-child(3) { left: 70%; animation-delay: 2s; }
.ember:nth-child(4) { left: 40%; animation-delay: 0.5s; }
.ember:nth-child(5) { left: 60%; animation-delay: 1.5s; }

@keyframes emberRise {
0% { transform: translateY(0) scale(0.8); opacity: 1; }
100% { transform: translateY(-100px) scale(0.2); opacity: 0; }
}

.smoke {
position: absolute;
bottom: 70px;
left: 50%;
transform: translateX(-50%);
width: 40px;
height: 150px;
z-index: 4;
}

.smoke-particle {
position: absolute;
bottom: 0;
width: 30px;
height: 30px;
background: rgba(100, 100, 100, 0.2);
border-radius: 50%;
filter: blur(10px);
opacity: 0;
animation: smokeRise 6s infinite;
}

.smoke-particle:nth-child(1) { left: 10%; animation-delay: 0s; }
.smoke-particle:nth-child(2) { left: 40%; animation-delay: 2s; }
.smoke-particle:nth-child(3) { left: 70%; animation-delay: 4s; }

@keyframes smokeRise {
0% { transform: translateY(0) scale(1); opacity: 0; }
20% { opacity: 0.4; }
100% { transform: translateY(-150px) scale(3); opacity: 0; }
}

/* Ciel √©toil√© */
.night-sky {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 60%;
z-index: 1;
overflow: hidden;
}

.star {
position: absolute;
width: 2px;
height: 2px;
background: white;
border-radius: 50%;
animation: starTwinkle 4s infinite alternate;
}

@keyframes starTwinkle {
0% { opacity: 0.3; }
100% { opacity: 1; }
}

/* Fond de terrain */
.ground {
position: absolute;
bottom: 0;
left: 0;
width: 100%;
height: 30px;
background: #111;
z-index: 2;
}

/* Dialogue box */
#cinematique-dialogue {
position: absolute;
bottom: 30px;
left: 50%;
transform: translateX(-50%);
width: 80%;
background: rgba(0, 0, 0, 0.8);
color: #fff;
padding: 20px;
border-radius: 10px;
font-family: 'Courier New', monospace;
border: 1px solid #555;
box-shadow: 0 0 15px rgba(139, 0, 0, 0.7);
z-index: 100;
}

#dialogue-text {
margin-bottom: 15px;
min-height: 80px;
line-height: 1.6;
}

#dialogue-faction {
display: none;
margin: 20px 0;
text-align: center;
}

.faction-container {
display: flex;
flex-wrap: wrap;
justify-content: center;
gap: 20px;
margin-top: 10px;
}

.faction-icon {
width: 80px;
height: 80px;
background: #111;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
border: 2px solid #444;
transition: all 0.3s;
box-shadow: 0 0 15px rgba(0,0,0,0.5);
color: white;
font-size: 24px;
font-weight: bold;
position: relative;
cursor: pointer;
}

.faction-icon::after {
content: attr(data-name);
position: absolute;
bottom: -25px;
left: 50%;
transform: translateX(-50%);
white-space: nowrap;
font-size: 12px;
color: #ccc;
}

.faction-lion { background: linear-gradient(135deg, #d4af37, #8b0000); }
.faction-shark { background: linear-gradient(135deg, #1e90ff, #000080); }
.faction-gator { background: linear-gradient(135deg, #006400, #000); }
.faction-pigz { background: linear-gradient(135deg, #ff69b4, #8b008b); }
.faction-eagle { background: linear-gradient(135deg, #f5f5f5, #4682b4); }
.faction-bearz { background: linear-gradient(135deg, #8b4513, #000); }
.faction-kobra { background: linear-gradient(135deg, #32cd32, #000); }
.faction-beez { background: linear-gradient(135deg, #ffd700, #000); }

.faction-icon:hover {
transform: scale(1.1);
box-shadow: 0 0 20px rgba(255,255,255,0.3);
}

#continue-btn {
padding: 10px 20px;
background: var(--accent);
color: white;
border: none;
border-radius: 5px;
font-family: 'Courier New', monospace;
cursor: pointer;
font-size: 16px;
transition: all 0.3s;
margin-top: 10px;
align-self: flex-end;
}

#continue-btn:hover {
background: #a00000;
box-shadow: 0 0 15px rgba(139, 0, 0, 0.7);
}

#skip-cinematique {
position: absolute;
top: 20px;
right: 20px;
padding: 8px 15px;
background: rgba(0, 0, 0, 0.6);
color: #ccc;
border: 1px solid #444;
border-radius: 5px;
cursor: pointer;
font-family: 'Courier New', monospace;
font-size: 14px;
transition: all 0.3s;
z-index: 101;
}

#skip-cinematique:hover {
background: rgba(139, 0, 0, 0.4);
color: white;
}

/* Carte des factions */
.faction-map {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
width: 80%;
height: 70%;
background: rgba(20, 20, 20, 0.7);
background-size: contain;
opacity: 0;
transition: opacity 1s ease-in-out;
border-radius: 8px;
box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
z-index: 50;
overflow: hidden;
}

.map-grid-lines {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-image: 
linear-gradient(rgba(50, 50, 50, 0.3) 1px, transparent 1px),
linear-gradient(90deg, rgba(50, 50, 50, 0.3) 1px, transparent 1px);
background-size: 50px 50px;
z-index: 51;
}

.territory-marker {
position: absolute;
width: 40px;
height: 40px;
border-radius: 50%;
background: rgba(255, 255, 255, 0.1);
display: flex;
align-items: center;
justify-content: center;
font-size: 24px;
color: white;
box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
opacity: 0;
transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
z-index: 52;
}

.territory-marker.visible {
opacity: 1;
transform: scale(1.2);
}

/* Blood overlay effect */
.blood-splatter {
position: fixed;
width: 100px;
height: 100px;
background: radial-gradient(circle, rgba(139, 0, 0, 0.8) 0%, rgba(139, 0, 0, 0) 70%);
pointer-events: none;
z-index: 9990;
opacity: 0;
transform: scale(0.5);
transition: all 0.5s ease-in-out;
}

@keyframes eyePulse {
          0% { box-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000; opacity: 0.7; }
          50% { box-shadow: 0 0 8px #ff0000, 0 0 15px #ff0000, 0 0 25px #ff0000; opacity: 1; }
          100% { box-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000; opacity: 0.7; }
        }

</style>
</head>

<body>
    <!-- CRT Scanline effect -->
    <div class="scanline"></div>
    
    <!-- Random glitch effect elements -->
    <div class="visual-glitch" style="--pos: 120px;"></div>
    <div class="visual-glitch" style="--pos: 240px;"></div>
    <div class="visual-glitch" style="--pos: 360px;"></div>
    
    <!-- Cin√©matique avec le survivant -->
    <div id="cinematique-container">
    <button id="skip-cinematique" onclick="skipCinematique()">PASSER ‚ñ∂‚ñ∂</button>
    
    <div id="cinematique-scene">
    <!-- Environnement post-apocalyptique -->
    <div class="night-sky">
    <!-- Stars will be added by JS -->
    </div>
    
    <div class="ruined-building ruined-building-1"></div>
    <div class="ruined-building ruined-building-2"></div>
    
    <div class="ground"></div>
    
    <!-- Survivant avec feu de camp -->
    <div id="cinematique-survivor">
        <div class="survivor-silhouette">
            <div class="survivor-head">
                <div class="survivor-hood"></div>
                <div class="survivor-face">
                    <div class="eyes">
                        <div class="eye eye-left"></div>
                        <div class="eye eye-right"></div>
                    </div>
                </div>
            </div>
            <div class="survivor-body"></div>
        </div>
    <div class="campfire">
        <div class="fire">
            <div class="flames">
                <div class="flame"></div>
                <div class="flame"></div>
                <div class="flame"></div>
            </div>
            <div class="logs">
                <div class="log log-1"></div>
                <div class="log log-2"></div>
                <div class="log log-3"></div>
            </div>
            <div class="glow"></div>
        </div>
    </div>
    
    <div class="embers">
        <div class="ember"></div>
        <div class="ember"></div>
        <div class="ember"></div>
        <div class="ember"></div>
        <div class="ember"></div>
    </div>
    
    <div class="smoke">
        <div class="smoke-particle"></div>
        <div class="smoke-particle"></div>
        <div class="smoke-particle"></div>
    </div>
    
    <div class="fire-light"></div>
    </div>

    <!-- Carte des factions -->
<div class="faction-map" id="faction-map">
    <div class="map-grid-lines"></div>
    <!-- Marqueurs de territoire -->
    <div class="territory-marker" style="top: 20%; left: 15%; background: #d4af37;" data-faction="lion">ü¶Å</div>
    <div class="territory-marker" style="top: 70%; left: 25%; background: #1e90ff;" data-faction="shark">ü¶à</div>
    <div class="territory-marker" style="top: 40%; left: 35%; background: #006400;" data-faction="gator">üêä</div>
    <div class="territory-marker" style="top: 25%; left: 65%; background: #ff69b4;" data-faction="pigz">üê∑</div>
    <div class="territory-marker" style="top: 15%; left: 85%; background: #4682b4;" data-faction="eagle">ü¶Ö</div>
    <div class="territory-marker" style="top: 60%; left: 80%; background: #8b4513;" data-faction="bearz">üêª</div>
    <div class="territory-marker" style="top: 50%; left: 60%; background: #32cd32;" data-faction="kobra">üêç</div>
    <div class="territory-marker" style="top: 80%; left: 50%; background: #ffd700;" data-faction="beez">üêù</div>
    </div>
    
    <!-- Dialogue box -->
    <div id="cinematique-dialogue">
    <div id="dialogue-text">
        <!-- Le texte sera ins√©r√© par JS -->
    </div>
    
    <!-- Section des factions -->
    <div id="dialogue-faction">
        <h3>LES 8 FACTIONS DE CE MONDE FRACTUR√â</h3>
        <div class="faction-container">
            <div class="faction-icon faction-lion" data-name="LIONS">ü¶Å</div>
            <div class="faction-icon faction-shark" data-name="SHARKS">ü¶à</div>
            <div class="faction-icon faction-gator" data-name="GATORS">üêä</div>
            <div class="faction-icon faction-pigz" data-name="PIGZ">üê∑</div>
            <div class="faction-icon faction-eagle" data-name="EAGLES">ü¶Ö</div>
            <div class="faction-icon faction-bearz" data-name="BEARZ">üêª</div>
            <div class="faction-icon faction-kobra" data-name="KOBRA">üêç</div>
            <div class="faction-icon faction-beez" data-name="BEEZ">üêù</div>
        </div>
    </div>
    
    <button id="continue-btn" onclick="nextDialogue()">CONTINUER ‚ñ∂</button>
    </div>
    </div>
    </div>
    
    <!-- Welcome screen avec camion et fond d'√©cran -->
    <div id="welcome-screen">
    <!-- Background elements -->
    <div class="welcome-background"></div>
    <div class="welcome-grid"></div>
    
    <!-- Truck graphic -->
    <div class="truck-container">
    <div class="truck">
    <div class="truck-body"></div>
    <div class="truck-cab">
        <div class="truck-window"></div>
    </div>
    <div class="truck-wheel wheel-front"></div>
    <div class="truck-wheel wheel-back"></div>
    <div class="truck-light"></div>
    </div>
    </div>
    
    <h1 id="welcome-title">Terminal DeadHope</h1>
    <div id="terminal-lines"></div>
    <div id="input-zone">
    <input id="input-pseudo" type="text" placeholder="Entre ton pseudo..." />
    <button id="start-button" onclick="startDashboard()">Acc√©der au terminal</button>
    </div>
    </div>

    <!-- Main dashboard content -->
<div id="dashboard-content" style="display: none;">
    <header>
    <div class="logo">
    <div class="logo-glow"></div>
    <h1>‚ò£Ô∏è DeadHope ‚ò£Ô∏è</h1>
    </div>
    <div class="info-bar">
    <div class="info-item">
        <span>üïí TEMPS √âCOUL√â:</span>
        <span id="game-clock" class="info-value">00h00</span>
    </div>
    <div class="info-item">
        <span>üå°Ô∏è TEMP√âRATURE:</span>
        <span id="weather-info" class="info-value">CHARGEMENT...</span>
    </div>
    
<div class="info-item" id="connected-users">
  üßç Connect√©s : <span class="info-value">Chargement...</span>
</div>

    <div class="info-item">
        <span>üì° DERNI√àRE MAJ:</span>
        <span id="last-updated" class="info-value">JAMAIS</span>
    </div>
    </div>
    </header>
    
    <nav>
    <a href="#tableau-bord">üìä Tableau de bord</a>
    <a href="#characters">üë• Personnages</a>
    <a href="#missions">üéØ Missions</a>
    <a href="#logistics">üì¶ Logistique</a>
    <a href="#zones">‚ö†Ô∏è Zones</a>
    <a href="#map">üó∫Ô∏è Carte</a>
    </nav>
    
    <main>
    <!-- Tableau de bord section -->
    <section id="tableau-bord">
    <h2>Tableau de bord</h2>
    
    <!-- Countdown timer to next event -->
    <div class="countdown">
        <div class="countdown-value" id="next-event-countdown">47:23:12</div>
        <div class="countdown-label">JUSQU'√Ä LA PROCHAINE TEMP√äTE DE ZOMBIES</div>
    </div>
    
    <!-- Stats overview -->
    <div class="stat-container">
        <div class="stat-card">
            <div class="stat-label">JOURS DE SURVIE</div>
            <div class="stat-value">12</div>
            <div class="progress-bar">
                <div class="progress-fill" style="--fill: 32%"></div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-label">TENSION DU GROUPE</div>
            <div class="stat-value">63%</div>
            <div class="progress-bar">
                <div class="progress-fill" style="--fill: 63%"></div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-label">RAVITAILLEMENT</div>
            <div class="stat-value">47%</div>
            <div class="progress-bar">
                <div class="progress-fill" style="--fill: 47%"></div>
            </div>
        </div>
    </div>
    </section>

    <!-- Character section with improved cards -->
<section id="characters">
    <h2>Fiches de personnage</h2>
    <button onclick="resetSection('character-list')">üßπ R√©initialiser</button>
    
    <div class="character-wrapper" id="character-list">
        <div class="character-card">
            <h3>FICHE D'IDENTIFICATION</h3>
            <input placeholder="Nom" type="text" value="John Carpenter"/>
            <input placeholder="R√¥le dans le groupe" type="text" value="M√©decin"/>
            <textarea placeholder="Notes ou observations...">A travaill√© 5 ans aux urgences. Connaissance en suture et traumatologie. A perdu sa famille lors de l'√©pid√©mie initiale.</textarea>
            <button onclick="this.parentElement.remove()">üóëÔ∏è Supprimer</button>
        </div>
        
        <div class="character-card">
            <h3>FICHE D'IDENTIFICATION</h3>
            <input placeholder="Nom" type="text" value="Sarah Miller"/>
            <input placeholder="R√¥le dans le groupe" type="text" value="Chef d'exp√©dition"/>
            <textarea placeholder="Notes ou observations...">Ancienne militaire. Sp√©cialiste en armes √† feu et tactique de groupe. Insomnies chroniques depuis l'incident de la Zone Rouge.</textarea>
            <button onclick="this.parentElement.remove()">üóëÔ∏è Supprimer</button>
        </div>
    </div>
    
    <button onclick="ajouterFichePerso()">‚ûï Ajouter un personnage</button>
    </section>
    
    <!-- Missions section -->
    <section id="missions">
    <h2>üéØ Missions</h2>
    <input id="filter-missions" oninput="filterTable('filter-missions', 'mission-body')" placeholder="üîç Rechercher..." />
    
    <table>
        <thead>
            <tr>
                <th>Objectif</th>
                <th>Responsable</th>
                <th>√âtat</th>
                <th>Deadline</th>
                <th></th>
            </tr>
        </thead>
        <tbody id="mission-body">
            <tr>
                <td><input type="text" placeholder="Ex: Fouiller maison au nord" value="Exploration du centre commercial"/></td>
                <td><input type="text" placeholder="Nom du joueur" value="Sarah Miller"/></td>
                <td>
                    <select>
                        <option selected>üü° En cours</option>
                        <option>‚úÖ Fait</option>
                        <option>‚ùå √âchou√©</option>
                    </select>
                </td>
                <td><input type="date" value="2025-04-15"/></td>
                <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
            </tr>
            <tr>
                <td><input type="text" placeholder="Ex: Fouiller maison au nord" value="R√©paration du g√©n√©rateur"/></td>
                <td><input type="text" placeholder="Nom du joueur" value="Mike Jenkins"/></td>
                <td>
                    <select>
                        <option>üü° En cours</option>
                        <option selected>‚úÖ Fait</option>
                        <option>‚ùå √âchou√©</option>
                    </select>
                </td>
                <td><input type="date" value="2025-04-11"/></td>
                <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
            </tr>
        </tbody>
    </table>
    
    <button onclick="ajouterMission()">‚ûï Ajouter une mission</button>
    </section>

    <!-- Journal / Events section with visual enhancements -->
<section id="journal">
    <h2>üìÖ Journal / √âv√©nements</h2>
    <input id="filter-journal" oninput="filterTable('filter-journal', 'journal-body')" placeholder="üîç Rechercher..." />
    
    <div class="timeline-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>√âv√©nement</th>
                    <th>Joueur</th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="journal-body">
                <tr>
                    <td><input type="date" value="2025-04-10"/></td>
                    <td><input type="text" placeholder="Description" value="Attaque de zombies pr√®s du campement"/></td>
                    <td><input type="text" placeholder="Nom du joueur" value="Tous"/></td>
                    <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
                </tr>
                <tr>
                    <td><input type="date" value="2025-04-11"/></td>
                    <td><input type="text" placeholder="Description" value="D√©couverte d'une cache de m√©dicaments"/></td>
                    <td><input type="text" placeholder="Nom du joueur" value="John Carpenter"/></td>
                    <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <button onclick="ajouterJournal()">‚ûï Ajouter une entr√©e</button>
    </section>
    
    <!-- Logistics section with icons and status colors -->
    <section id="logistics">
    <h2>üì¶ Logistique / Mat√©riel</h2>
    <input id="filter-logistique" oninput="filterTable('filter-logistique', 'logistique-body')" placeholder="üîç Rechercher..." />
    
    <table>
        <thead>
            <tr>
                <th>Type</th>
                <th>Nom</th>
                <th>√âtat</th>
                <th>Emplacement</th>
                <th></th>
            </tr>
        </thead>
        <tbody id="logistique-body">
            <tr>
                <td>
                    <select>
                        <option selected>üî´ Arme</option>
                        <option>üöó V√©hicule</option>
                        <option>üß∞ Outil</option>
                        <option>ü©π Soins</option>
                        <option>üìª √âlectronique</option>
                    </select>
                </td>
                <td><input type="text" placeholder="Nom ou mod√®le" value="Fusil √† pompe Remington"/></td>
                <td>
                    <select onchange="checkEtat(this)">
                        <option selected>‚úÖ Fonctionnel</option>
                        <option>‚ö†Ô∏è Endommag√©</option>
                        <option>‚ùå Hors service</option>
                    </select>
                </td>
                <td><input type="text" placeholder="O√π ? ou Avec qui ?" value="Armurerie du camp"/></td>
                <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
            </tr>
            <tr style="background-color: rgba(74, 60, 28, 0.4);">
                <td>
                    <select>
                        <option>üî´ Arme</option>
                        <option selected>üöó V√©hicule</option>
                        <option>üß∞ Outil</option>
                        <option>ü©π Soins</option>
                        <option>üìª √âlectronique</option>
                    </select>
                </td>
                <td><input type="text" placeholder="Nom ou mod√®le" value="Jeep Cherokee 2022"/></td>
                <td>
                    <select onchange="checkEtat(this)">
                        <option>‚úÖ Fonctionnel</option>
                        <option selected>‚ö†Ô∏è Endommag√©</option>
                        <option>‚ùå Hors service</option>
                    </select>
                </td>
                <td><input type="text" placeholder="O√π ? ou Avec qui ?" value="Garage Est"/></td>
                <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
            </tr>
        </tbody>
    </table>
    
    <button onclick="ajouterLogistique()">‚ûï Ajouter un item</button>
    </section>

    <!-- Danger zones with visual heat map -->
<section id="zones">
    <h2>‚ö†Ô∏è Zones dangereuses</h2>
    
    <div class="danger-grid-wrapper" id="danger-zone-container">
        <div class="danger-zone-entry" style="border-left: 4px solid #e74c3c;">
            <input type="text" placeholder="Nom du lieu" value="Centre commercial Westfield"/>
            <select>
                <option>Faible</option>
                <option>Mod√©r√©</option>
                <option>√âlev√©</option>
                <option selected>Extr√™me</option>
            </select>
            <input type="text" placeholder="Informations" value="Horde massive de zombies, √©viter √† tout prix"/>
            <button onclick="this.parentElement.remove()">üóëÔ∏è</button>
        </div>
        
        <div class="danger-zone-entry" style="border-left: 4px solid #f39c12;">
            <input type="text" placeholder="Nom du lieu" value="H√¥pital Saint-Michael"/>
            <select>
                <option>Faible</option>
                <option>Mod√©r√©</option>
                <option selected>√âlev√©</option>
                <option>Extr√™me</option>
            </select>
            <input type="text" placeholder="Informations" value="M√©dicaments disponibles mais lieu infest√©"/>
            <button onclick="this.parentElement.remove()">üóëÔ∏è</button>
        </div>
    </div>
    
    <button onclick="ajouterZoneDangereuse()">‚ûï Ajouter une zone</button>
    
    <!-- Interactive heat map visualization -->
    <div class="heat-map-container" style="margin-top: 2rem;">
        <h3 style="color: #f39c12; border-bottom: 1px solid #333; padding-bottom: 0.5rem;">Carte de chaleur des dangers</h3>
        <div style="position: relative; margin-top: 1rem;">
            <svg viewBox="0 0 800 400" style="width: 100%; height: auto; border: 1px solid #333; border-radius: 8px; background: #111;">
                <!-- Zone circles with danger levels -->
                <circle cx="200" cy="150" r="70" fill="url(#danger-extreme)" opacity="0.7"></circle>
                <circle cx="450" cy="220" r="50" fill="url(#danger-high)" opacity="0.7"></circle>
                <circle cx="650" cy="100" r="40" fill="url(#danger-medium)" opacity="0.7"></circle>
                <circle cx="300" cy="300" r="60" fill="url(#danger-low)" opacity="0.7"></circle>
                
                <!-- City markers -->
                <g transform="translate(200, 150)">
                    <circle cx="0" cy="0" r="10" fill="#111" stroke="#e74c3c" stroke-width="2"></circle>
                    <text x="15" y="5" fill="#e74c3c" font-size="12" font-family="monospace">Centre commercial</text>
                </g>
                
                <g transform="translate(450, 220)">
                    <circle cx="0" cy="0" r="10" fill="#111" stroke="#f39c12" stroke-width="2"></circle>
                    <text x="15" y="5" fill="#f39c12" font-size="12" font-family="monospace">H√¥pital</text>
                </g>
                
                <g transform="translate(650, 100)">
                    <circle cx="0" cy="0" r="10" fill="#111" stroke="#f1c40f" stroke-width="2"></circle>
                    <text x="15" y="5" fill="#f1c40f" font-size="12" font-family="monospace">Station-service</text>
                </g>
                
                <g transform="translate(300, 300)">
                    <circle cx="0" cy="0" r="10" fill="#111" stroke="#2ecc71" stroke-width="2"></circle>
                    <text x="15" y="5" fill="#2ecc71" font-size="12" font-family="monospace">Zone r√©sidentielle</text>
                </g>
                
                <!-- Camp position -->
                <g transform="translate(100, 100)">
                    <path d="M0,-15 L10,5 L-10,5 Z" fill="#00bcd4"></path>
                    <circle cx="0" cy="0" r="20" fill="none" stroke="#00bcd4" stroke-width="2" opacity="0.7">
                        <animate attributeName="r" from="20" to="30" dur="2s" repeatCount="indefinite" />
                        <animate attributeName="opacity" from="0.7" to="0" dur="2s" repeatCount="indefinite" />
                    </circle>
                    <text x="15" y="5" fill="#00bcd4" font-size="14" font-weight="bold" font-family="monospace">CAMP</text>
                </g>
                
                <!-- Gradient definitions -->
                <defs>
                    <radialGradient id="danger-extreme" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                        <stop offset="0%" stop-color="#e74c3c" />
                        <stop offset="100%" stop-color="transparent" />
                    </radialGradient>
                    
                    <radialGradient id="danger-high" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                        <stop offset="0%" stop-color="#f39c12" />
                        <stop offset="100%" stop-color="transparent" />
                    </radialGradient>
                    
                    <radialGradient id="danger-medium" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                        <stop offset="0%" stop-color="#f1c40f" />
                        <stop offset="100%" stop-color="transparent" />
                    </radialGradient>
                    
                    <radialGradient id="danger-low" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                        <stop offset="0%" stop-color="#2ecc71" />
                        <stop offset="100%" stop-color="transparent" />
                    </radialGradient>
                </defs>
            </svg>
            
            <div class="map-legend" style="display: flex; justify-content: space-around; margin-top: 1rem; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px;">
                <div style="display: flex; align-items: center; gap: 5px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background: #e74c3c; border-radius: 50%;"></span>
                    <span>Extr√™me</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background: #f39c12; border-radius: 50%;"></span>
                    <span>√âlev√©</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background: #f1c40f; border-radius: 50%;"></span>
                    <span>Mod√©r√©</span>
                </div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <span style="display: inline-block; width: 15px; height: 15px; background: #2ecc71; border-radius: 50%;"></span>
                    <span>Faible</span>
                </div>
            </div>
        </div>
    </div>
    </section>

    <!-- Interactive map section avec carte personnalis√©e au lieu de l'iframe qui ne fonctionne pas -->
<section id="map">
    <h2>üó∫Ô∏è CARTE INTERACTIVE</h2>
    
    <div class="custom-map">
        <!-- Map grid background -->
        <div class="map-grid"></div>
        
        <!-- Error message instead of iframe -->
        <div class="map-error">ERR_BLOCKED_BY_CSP</div>
        <div class="map-title">MAP.PROJECTZOMBOID.COM<br/>EST BLOQU√â</div>
        <div class="map-message">Ce contenu est bloqu√©. Pour r√©soudre le probl√®me, contactez le propri√©taire du site.</div>
        
        <!-- Warning symbols -->
        <div class="map-warning warning-left">
            <div class="warning-triangle"></div>
        </div>
        <div class="map-warning warning-right">
            <div class="warning-triangle"></div>
        </div>
        
        <!-- Custom interactive map locations -->
        <div class="map-location location-1">
            <div class="location-pulse" style="background: #e74c3c;"></div>
        </div>
        <div class="map-location location-2">
            <div class="location-pulse" style="background: #2ecc71;"></div>
        </div>
        <div class="map-location location-3">
            <div class="location-pulse" style="background: #3498db;"></div>
        </div>
        <div class="map-location location-4">
            <div class="location-pulse" style="background: #f1c40f;"></div>
        </div>
        
        <!-- Map legend -->
        <div class="map-legend">
            <div class="legend-title">L√âGENDE</div>
            <div class="legend-item">
                <div class="legend-circle" style="background: #e74c3c;"></div>
                <span>Zone infest√©e</span>
            </div>
            <div class="legend-item">
                <div class="legend-circle" style="background: #2ecc71;"></div>
                <span>Zone s√©curis√©e</span>
            </div>
            <div class="legend-item">
                <div class="legend-circle" style="background: #3498db;"></div>
                <span>Point d'int√©r√™t</span>
            </div>
        </div>
    </div>
    </section>
    </main>

    <!-- Chat radio button with notification -->
<button id="chat-toggle" onclick="toggleChat()">
    üí¨
    <span class="msg-notification">3</span>
    </button>
    
    <!-- Chat radio panel -->
    <section id="radio-chat" style="display:none;">
    <h2>üìª Communications radio</h2>
    <div style="margin-bottom: 10px; display: flex; gap: 5px;">
    <input id="chat-input" type="text" placeholder="Tape ton message..." style="flex: 1;"/>
    <button onclick="sendMessage()" style="width: auto; display: flex; align-items: center; gap: 5px;">
        <span>Envoyer</span> üì°
    </button>
    </div>
    
    <div id="chat-log">
    <div class="chat-message">
        <strong style="color:#8f8">Syst√®me</strong> <span style="color:#888">[08:45]</span>: Bienvenue sur la fr√©quence d'urgence.
    </div>
    <div class="chat-message">
        <strong style="color:#f55">Sarah</strong> <span style="color:#888">[09:12]</span>: Attention, hordes signal√©es au nord du centre commercial.
    </div>
    <div class="chat-message">
        <strong style="color:#5af">John</strong> <span style="color:#888">[09:15]</span>: Re√ßu. On √©vite cette zone pour l'exp√©dition d'aujourd'hui.
    </div>
    </div>
    </section>
    </div>
    
    <!-- Audio elements -->
    <audio id="background-sound" loop volume="0.2">
    <source src="https://actions.google.com/sounds/v1/ambiences/abandoned_facility.ogg" type="audio/ogg">
    </audio>
    <audio id="boot-sound" preload="auto">
    <source src="https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg" type="audio/ogg">
    </audio>
    <audio id="confirm-sound" preload="auto">
    <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
    </audio>
    <audio id="radio-bip" preload="auto">
    <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
    </audio>

    <script>
        // Store the user's pseudo
        window.pseudo = "Anonyme";
        
        // Terminal welcome screen typing effect
        const lines = [
        "Initialisation du protocole DeadHope v2.7...",
        "Connexion aux bases de donn√©es s√©curis√©es...",
        "Chargement de la carte tactique de Knox County...",
        "√âtablissement des liaisons radio d'urgence...",
        "Analyse des zones de danger en temps r√©el...",
        "Estimation des mouvements de zombies...",
        "Authentification requise pour acc√©der au terminal."
        ];
        
        let currentLine = 0;
        function typeNextLine() {
        if (currentLine >= lines.length) {
        document.getElementById("input-zone").style.display = "block";
        return;
        }
        
        const terminal = document.getElementById("terminal-lines");
        const newLine = document.createElement("div");
        newLine.textContent = "";
        terminal.appendChild(newLine);
        
        let i = 0;
        const text = lines[currentLine];
        const typeInterval = setInterval(() => {
        if (i < text.length) {
            newLine.textContent += text[i++];
        } else {
            clearInterval(typeInterval);
            currentLine++;
            setTimeout(typeNextLine, 500);
        }
        }, 30);
        }
        
        // CIN√âMATIQUE LOGIC
        const dialogues = [
        "Bienvenue, survivant. Je suis le Veilleur, l'un des rares √† avoir observ√© le d√©but de tout ceci. Tu as besoin de savoir ce qui s'est pass√©, n'est-ce pas?",
        "Il y a trois ans, un laboratoire secret a cr√©√© ce qu'ils appelaient 'l'Am√©lioration Humaine'. Un virus con√ßu pour gu√©rir toutes les maladies... Quelle ironie.",
        "Un accident. Une fuite. Puis le chaos. En 72 heures, les grandes villes √©taient tomb√©es. Les morts se relevaient, affam√©s, sans conscience, cherchant uniquement √† propager l'infection.",
        "Ce que tu vois aujourd'hui n'est que l'ombre de notre monde. Les gouvernements se sont effondr√©s. Les militaires ont √©t√© submerg√©s. Seuls les plus forts, les plus rus√©s ont surv√©cu.",
        "Et pendant que l'humanit√© luttait contre ces hordes de morts-vivants, une autre menace est apparue. Les survivants se sont divis√©s. Le pouvoir, les ressources, la survie... tout est devenu motif de guerre.",
        "C'est ainsi que sont n√©es les huit factions qui se partagent d√©sormais ce qu'il reste de notre monde...",
        "Les Lions - Dirig√©s par l'ancien g√©n√©ral Marcus Reed. Discipline militaire, puissance de feu. Ils croient que seule une main de fer peut reconstruire la civilisation.",
        "Les Sharks - Ma√Ætres des mers et des c√¥tes. Experts en navigation et commerce. Leur flotte est la derni√®re √† sillonner les oc√©ans, transportant marchandises et informations.",
        "Les Gators - Habitants des marais et zones sauvages. Chasseurs redoutables, experts en survie. Ils connaissent les secrets de la nature et des rem√®des anciens.",
        "Les Pigz - Une faction h√©doniste et opportuniste. Ils contr√¥lent les derni√®res zones de divertissement et plaisirs. Derri√®re leurs sourires se cachent des n√©gociants impitoyables.",
        "Les Eagles - Technologues et visionnaires. Ils op√®rent depuis les hauteurs, utilisant drones et technologies avanc√©es. Ils cherchent un rem√®de, une solution scientifique.",
        "Les Bearz - Gardiens des for√™ts et montagnes. Communaut√© autosuffisante et protectrice. Ils offrent refuge, mais leurs territoires sont f√©rocement d√©fendus.",
        "Les Kobra - Culte myst√©rieux qui croit que l'apocalypse est une purification divine. Manipulateurs, infiltr√©s partout. M√©fie-toi de leurs promesses de salvation.",
        "Les Beez - Collectif organis√© autour du bien commun. Syst√®me de ruche, travail communal. Ils reconstruisent m√©thodiquement, mais l'individualisme y est sacrifi√©.",
        "Tu dois choisir ton camp, ou rester ind√©pendant. Mais sache que dans ce monde, personne ne survit seul. Les zombies sont une menace constante, mais les humains peuvent √™tre bien pires.",
        "Je t'ai confi√© ce terminal tactique, utilis√© par tous les survivants ind√©pendants. Il te permettra de suivre les mouvements, communiquer, et peut-√™tre... trouver un sens √† ta survie.",
        "Bonne chance, " // Sera compl√©t√© avec pseudo dans la fonction
        ];
        
        let dialogueIndex = 0;

        // Start dashboard after authentication
function startDashboard() {
const input = document.getElementById("input-pseudo");
const pseudo = input.value.trim();

if (!pseudo) {
input.style.border = "1px solid #e74c3c";
input.placeholder = "‚ö†Ô∏è PSEUDO REQUIS!";
return;
}

input.disabled = true;
window.pseudo = pseudo;

// Play confirmation sound
document.getElementById("confirm-sound").play().catch(() => {});

const terminal = document.getElementById("terminal-lines");
terminal.innerHTML += `\n\nBienvenue, OP√âRATEUR: <span style="color: #8b0000; font-weight: bold">${pseudo.toUpperCase()}</span>\nInitialisation du terminal tactique...`;

// Add a loading animation
const loadingDiv = document.createElement("div");
loadingDiv.innerHTML = "<div style='margin-top: 10px; display: flex; justify-content: center;'><div class='typing-indicator'>‚ñ†</div></div>";
terminal.appendChild(loadingDiv);

// Lancer la cin√©matique au lieu d'aller directement au tableau de bord
setTimeout(() => {
document.getElementById("welcome-screen").style.display = "none";
startCinematique();
}, 2000);
}

// Fonction pour d√©marrer la cin√©matique
function startCinematique() {
const container = document.getElementById("cinematique-container");
container.style.display = "flex";

// Ajout des √©toiles dans le ciel nocturne
const nightSky = document.querySelector('.night-sky');
for (let i = 0; i < 50; i++) {
const star = document.createElement('div');
star.classList.add('star');
star.style.top = Math.random() * 100 + '%';
star.style.left = Math.random() * 100 + '%';
star.style.animationDelay = Math.random() * 4 + 's';
nightSky.appendChild(star);
}

setTimeout(() => {
container.style.opacity = "1";
showDialogue(0);

// Jouer sons ambiants de la cin√©matique
document.getElementById("background-sound").volume = 0.3;
document.getElementById("background-sound").play().catch(() => {});
}, 100);
}

// Afficher le dialogue actuel
function showDialogue(index) {
let text = dialogues[index];

// Ajouter le pseudo au dernier dialogue
if (index === dialogues.length - 1) {
text += window.pseudo + ". Que la mort ne soit pas ton espoir final.";
}

const element = document.getElementById("dialogue-text");
element.innerHTML = "";

// Effets sp√©ciaux pour certains dialogues
if (index === 5) {
// Montrer les factions
document.getElementById("dialogue-faction").style.display = "block";
} else {
document.getElementById("dialogue-faction").style.display = "none";
}

// Afficher la carte des factions
if (index === 6) {
document.getElementById("faction-map").style.opacity = "0.8";
showTerritoryMarker("lion");
} else if (index === 7) {
showTerritoryMarker("shark");
} else if (index === 8) {
showTerritoryMarker("gator");
} else if (index === 9) {
showTerritoryMarker("pigz");
} else if (index === 10) {
showTerritoryMarker("eagle");
} else if (index === 11) {
showTerritoryMarker("bearz");
} else if (index === 12) {
showTerritoryMarker("kobra");
} else if (index === 13) {
showTerritoryMarker("beez");
} else if (index > 13 || index < 6) {
document.getElementById("faction-map").style.opacity = "0";
document.querySelectorAll(".territory-marker").forEach(marker => {
    marker.classList.remove("visible");
});
}

// Animation d'√©criture du texte
let i = 0;
const typeInterval = setInterval(() => {
if (i < text.length) {
    element.innerHTML += text[i++];
} else {
    clearInterval(typeInterval);
}
}, 30);
}

// Afficher marqueur de territoire
function showTerritoryMarker(faction) {
document.querySelectorAll(".territory-marker").forEach(marker => {
marker.classList.remove("visible");
});

const marker = document.querySelector(`.territory-marker[data-faction="${faction}"]`);
if (marker) {
marker.classList.add("visible");
}
}

// Passer au dialogue suivant
function nextDialogue() {
dialogueIndex++;

if (dialogueIndex >= dialogues.length) {
// Fin de la cin√©matique, passer au tableau de bord
endCinematique();
return;
}

// Jouer son de transition
document.getElementById("radio-bip").play().catch(() => {});
showDialogue(dialogueIndex);
}

// Passer la cin√©matique
function skipCinematique() {
document.getElementById("confirm-sound").play().catch(() => {});
endCinematique();
}

// Terminer la cin√©matique et montrer le tableau de bord
function endCinematique() {
const container = document.getElementById("cinematique-container");
container.style.opacity = "0";

setTimeout(() => {
container.style.display = "none";
document.getElementById("dashboard-content").style.display = "block";
document.getElementById("background-sound").play().catch(() => {});
updateTimestamp();
}, 1000);
}

// Utility functions
function updateTimestamp() {
const now = new Date();
const formatted = now.toLocaleString("fr-FR");
document.getElementById("last-updated").textContent = formatted;
}

function filterTable(inputId, tableBodyId) {
const input = document.getElementById(inputId).value.toLowerCase();
const rows = document.getElementById(tableBodyId).querySelectorAll("tr");

rows.forEach(row => {
const text = row.innerText.toLowerCase();
row.style.display = text.includes(input) ? "" : "none";
});
}

function resetSection(sectionId) {
const el = document.getElementById(sectionId);

if (el) {
if (sectionId.includes('body')) {
    // For tables, keep first row as template
    const firstRow = el.querySelector('tr');
    el.innerHTML = '';
    
    if (firstRow) {
        const newRow = firstRow.cloneNode(true);
        newRow.querySelectorAll('input').forEach(input => input.value = '');
        newRow.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
        el.appendChild(newRow);
    }
} else {
    // For other containers
    const firstItem = el.children[0];
    el.innerHTML = '';
    
    if (firstItem) {
        const newItem = firstItem.cloneNode(true);
        newItem.querySelectorAll('input, textarea').forEach(input => input.value = '');
        newItem.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
        el.appendChild(newItem);
    }
}
}
}

// Check equipment status and change row color
function checkEtat(select) {
const row = select.closest("tr");
const value = select.value;

if (value.includes("‚ùå")) {
row.style.backgroundColor = "rgba(74, 28, 28, 0.4)";
} else if (value.includes("‚ö†Ô∏è")) {
row.style.backgroundColor = "rgba(74, 60, 28, 0.4)";
} else {
row.style.backgroundColor = "transparent";
}
}

// Add new entries to tables
function ajouterFichePerso() {
const list = document.getElementById("character-list");
const original = list.children[0];
const clone = original.cloneNode(true);

clone.querySelectorAll("input, textarea").forEach(el => el.value = "");
clone.querySelectorAll("select").forEach(el => el.selectedIndex = 0);

list.appendChild(clone);
}

function ajouterJournal() {
const tbody = document.getElementById("journal-body");
const clone = tbody.rows[0].cloneNode(true);

clone.querySelectorAll("input").forEach(el => el.value = "");
tbody.appendChild(clone);
}

function ajouterMission() {
const tbody = document.getElementById("mission-body");
const clone = tbody.rows[0].cloneNode(true);

clone.querySelectorAll("input").forEach(el => el.value = "");
clone.querySelector("select").selectedIndex = 0;

tbody.appendChild(clone);
}

function ajouterLogistique() {
const tbody = document.getElementById("logistique-body");
const clone = tbody.rows[0].cloneNode(true);

clone.querySelectorAll("input").forEach(el => el.value = "");
clone.querySelectorAll("select").forEach(el => el.selectedIndex = 0);
clone.style.backgroundColor = "transparent";

tbody.appendChild(clone);
}

function ajouterZoneDangereuse() {
const container = document.getElementById("danger-zone-container");
const clone = container.firstElementChild.cloneNode(true);

clone.querySelectorAll("input").forEach(input => input.value = "");
clone.style.borderLeftColor = "#333";

container.appendChild(clone);
}

// Chat functions
function toggleChat() {
const box = document.getElementById("radio-chat");
box.style.display = box.style.display === "none" ? "block" : "none";

// Remove notification when opening chat
if (box.style.display === "block") {
const notification = document.querySelector(".msg-notification");
if (notification) notification.style.display = "none";
}
}

function sendMessage() {
const input = document.getElementById("chat-input");
const text = input.value.trim();

if (!text) return;

const chatLog = document.getElementById("chat-log");
const now = new Date();
const time = now.toLocaleTimeString("fr-FR", { hour: '2-digit', minute: '2-digit' });

const msgDiv = document.createElement("div");
msgDiv.classList.add("chat-message", "fade-in");
msgDiv.innerHTML = `<strong style="color:#5af">${window.pseudo}</strong> <span style="color:#888">[${time}]</span>: ${text}`;

chatLog.appendChild(msgDiv);
chatLog.scrollTop = chatLog.scrollHeight;

input.value = "";

// Play radio sound
document.getElementById("radio-bip").play().catch(() => {});
}

// Game clock update
let gameMinutes = 8 * 60;
const gameSpeed = 2; // Minutes per real minute

function updateGameClock() {
const hours = Math.floor(gameMinutes / 60) % 24;
const minutes = gameMinutes % 60;

document.getElementById("game-clock").textContent = `${hours.toString().padStart(2, '0')}h${minutes.toString().padStart(2, '0')}`;

gameMinutes += gameSpeed;

// Update countdowns and other time-based elements
updateCountdown();
}

// Countdown to next event
let countdownMinutes = 47 * 60 + 23 * 60 + 12; // 47:23:12

function updateCountdown() {
if (countdownMinutes <= 0) {
// Reset countdown or trigger event
countdownMinutes = Math.floor(Math.random() * 24 * 60 * 60); // Random time within 24 hours
}

const hours = Math.floor(countdownMinutes / 3600);
const minutes = Math.floor((countdownMinutes % 3600) / 60);
const seconds = countdownMinutes % 60;

document.getElementById("next-event-countdown").textContent = 
`${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

countdownMinutes--;
}

// Map location interaction
function setupMapInteraction() {
const locations = document.querySelectorAll('.map-location');

locations.forEach(location => {
location.addEventListener('click', function() {
    // Show a simple tooltip with information
    let tooltip = document.createElement('div');
    tooltip.style.position = 'absolute';
    tooltip.style.background = 'rgba(0,0,0,0.8)';
    tooltip.style.color = '#fff';
    tooltip.style.padding = '10px';
    tooltip.style.borderRadius = '5px';
    tooltip.style.zIndex = '100';
    tooltip.style.maxWidth = '200px';
    tooltip.style.top = (this.offsetTop - 60) + 'px';
    tooltip.style.left = (this.offsetLeft + this.offsetWidth/2 - 100) + 'px';
    
    // Determine tooltip content based on location class
    if (this.classList.contains('location-1')) {
        tooltip.innerHTML = '<strong>Centre commercial</strong><br>Zone √† haut risque, forte concentration de zombies. Richesse en ressources.';
    } else if (this.classList.contains('location-2')) {
        tooltip.innerHTML = '<strong>Zone r√©sidentielle</strong><br>Zone s√©curis√©e, patrouill√©e r√©guli√®rement. Abris et provisions disponibles.';
    } else if (this.classList.contains('location-3')) {
        tooltip.innerHTML = '<strong>Station service</strong><br>Point d\'int√©r√™t. Carburant et pi√®ces m√©caniques disponibles.';
    } else if (this.classList.contains('location-4')) {
        tooltip.innerHTML = '<strong>H√¥pital</strong><br>Risque mod√©r√©, concentrations de zombies sporadiques. Ressources m√©dicales.';
    }
    
    const mapContainer = document.querySelector('.custom-map');
    mapContainer.appendChild(tooltip);
    
    // Remove tooltip after a delay
    setTimeout(() => {
        tooltip.remove();
    }, 3000);
});
});
}

// Animate truck in welcome screen
function animateTruck() {
const truck = document.querySelector('.truck');

// Add some subtle motion to the truck
truck.style.animation = 'truckIdle 2s infinite alternate';

// Define the animation in stylesheet
const style = document.createElement('style');
style.textContent = `
@keyframes truckIdle {
    0% { transform: translateY(0); }
    100% { transform: translateY(-3px); }
}
`;
document.head.appendChild(style);
}

// Weather simulation effect
function simulateWeather() {
// Create a random weather effect (rain, fog, clear)
const weatherTypes = ['rain', 'fog', 'clear'];
const randomWeather = weatherTypes[Math.floor(Math.random() * weatherTypes.length)];
const weatherTemp = Math.floor(Math.random() * 30 - 5); // -5 to 25 degrees

document.getElementById("weather-info").textContent = `${weatherTemp}¬∞C`;

// Add visual effect based on weather
const style = document.createElement('style');

if (randomWeather === 'rain') {
document.getElementById("weather-info").textContent = `üåßÔ∏è ${weatherTemp}¬∞C`;
style.textContent = `
    body::before {
        background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8));
    }
`;
} else if (randomWeather === 'fog') {
document.getElementById("weather-info").textContent = `üå´Ô∏è ${weatherTemp}¬∞C`;
style.textContent = `
    body::before {
        background: linear-gradient(rgba(20,20,30,0.8), rgba(20,20,30,0.8));
    }
`;
} else {
document.getElementById("weather-info").textContent = `‚òÄÔ∏è ${weatherTemp}¬∞C`;
style.textContent = `
    body::before {
        background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6));
    }
`;
}

document.head.appendChild(style);
}

// Add blood splatter visual effect
function addBloodSplatterEffect() {
document.body.addEventListener('click', function(e) {
if (Math.random() > 0.7) { // 30% chance on any click
    const splatter = document.createElement('div');
    splatter.classList.add('blood-splatter');
    splatter.style.left = (e.clientX - 50) + 'px';
    splatter.style.top = (e.clientY - 50) + 'px';
    document.body.appendChild(splatter);
    
    // Animate and remove
    setTimeout(() => {
        splatter.style.transform = 'scale(1.5)';
        splatter.style.opacity = '0.7';
        
        setTimeout(() => {
            splatter.style.opacity = '0';
            setTimeout(() => {
                splatter.remove();
            }, 500);
        }, 100);
    }, 10);
}
});
}

// Initialize on page load
window.addEventListener("load", () => {
// Start terminal boot sequence
document.getElementById("boot-sound").play().catch(() => {});
typeNextLine();

// Set up intervals for game clock and other periodic updates
setInterval(updateGameClock, 60000 / gameSpeed);
setInterval(updateCountdown, 1000);

// Initialize extra visual effects
animateTruck();
simulateWeather();
setupMapInteraction();
addBloodSplatterEffect();

// Listen for Enter key on login
document.getElementById("input-pseudo").addEventListener("keypress", function(e) {
if (e.key === "Enter") startDashboard();
});

// Listen for Enter key on chat input
document.getElementById("chat-input").addEventListener("keypress", function(e) {
if (e.key === "Enter") sendMessage();
});

// Initialisation des interactions avec les factions
document.querySelectorAll('.faction-icon').forEach(icon => {
icon.addEventListener('mouseover', function() {
    this.style.transform = 'scale(1.1)';
    this.style.boxShadow = '0 0 20px ' + getComputedStyle(this).backgroundColor;
});

icon.addEventListener('mouseout', function() {
    this.style.transform = '';
    this.style.boxShadow = '';
});

icon.addEventListener('click', function() {
    // Ajouter un effet visuel au clic
    const pulse = document.createElement('div');
    pulse.style.position = 'absolute';
    pulse.style.top = '0';
    pulse.style.left = '0';
    pulse.style.right = '0';
    pulse.style.bottom = '0';
    pulse.style.borderRadius = '50%';
    pulse.style.background = 'rgba(255,255,255,0.3)';
    pulse.style.transform = 'scale(0)';
    pulse.style.transition = 'all 0.5s';
    
    this.appendChild(pulse);
    
    setTimeout(() => {
        pulse.style.transform = 'scale(3)';
        pulse.style.opacity = '0';
        setTimeout(() => pulse.remove(), 500);
    }, 10);
    
    // Afficher des infos sur la faction
    const factionName = this.getAttribute('data-name');
    const dialogueElement = document.getElementById('dialogue-text');
    let factionDescription = '';
    
    switch(factionName) {
        case 'LIONS':
            factionDescription = "Les Lions - Force militaire dominante. Ils maintiennent l'ordre par la force et contr√¥lent les anciens sites gouvernementaux.";
            break;
        case 'SHARKS':
            factionDescription = "Les Sharks - Ma√Ætres des oc√©ans et des c√¥tes. Leur r√©seau maritime est vital pour le commerce et les communications entre les zones isol√©es.";
            break;
        case 'GATORS':
            factionDescription = "Les Gators - Survivalistes des marais. Experts en m√©decine naturelle et en techniques de chasse. Ils sont impitoyables envers les intrus.";
            break;
        case 'PIGZ':
            factionDescription = "Les Pigz - Cette faction contr√¥le le divertissement et le luxe. Sous leurs airs festifs se cache un r√©seau d'espionnage redoutable.";
            break;
        case 'EAGLES':
            factionDescription = "Les Eagles - Technocrates et scientifiques. Ils recherchent un rem√®de tout en d√©veloppant des technologies pour surveiller et contr√¥ler les zones infect√©es.";
            break;
        case 'BEARZ':
            factionDescription = "Les Bearz - Communaut√©s des montagnes. Autosuffisants et isolationnistes, ils offrent refuge mais exigent loyaut√© absolue.";
            break;
        case 'KOBRA':
            factionDescription = "Les Kobra - Culte mystique qui v√©n√®re l'infection comme une √©volution divine. Leurs agents sont infiltr√©s dans toutes les autres factions.";
            break;
        case 'BEEZ':
            factionDescription = "Les Beez - Soci√©t√© collectiviste organis√©e en ruche. Efficaces et pragmatiques, ils reconstruisent m√©thodiquement tout en sacrifiant l'individualit√©.";
            break;
    }
    
    dialogueElement.innerHTML = factionDescription;
    
    // Afficher le territoire sur la carte
    showTerritoryMarker(factionName.toLowerCase());
    
     });
   });
 });

// SYST√àME DE SYNCHRONISATION EN TEMPS R√âEL

// Fonction pour sauvegarder l'√©tat complet de l'application
function saveStateToLocalStorage() {
    // Collecter toutes les donn√©es de l'application
    const appState = {
        characters: collectCharactersData(),
        missions: collectMissionsData(),
        journal: collectJournalData(),
        logistics: collectLogisticsData(),
        dangerZones: collectDangerZonesData(),
        gameTime: {
            gameMinutes: gameMinutes,
            countdownMinutes: countdownMinutes
        },
        lastSaved: new Date().toISOString(),
        pseudo: window.pseudo
    };
    
    // Sauvegarder dans localStorage
    localStorage.setItem('deadhope-state', JSON.stringify(appState));
}

// Fonctions pour collecter les donn√©es (identiques au code pr√©c√©dent)
function collectCharactersData() {
    const characterCards = document.querySelectorAll('#character-list .character-card');
    const characters = [];
    
    characterCards.forEach(card => {
        const inputs = card.querySelectorAll('input');
        const textarea = card.querySelector('textarea');
        
        characters.push({
            name: inputs[0]?.value || '',
            role: inputs[1]?.value || '',
            notes: textarea?.value || ''
        });
    });
    
    return characters;
}

function collectMissionsData() {
    const missionRows = document.querySelectorAll('#mission-body tr');
    const missions = [];
    
    missionRows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        const select = row.querySelector('select');
        
        missions.push({
            objective: inputs[0]?.value || '',
            responsible: inputs[1]?.value || '',
            status: select?.options[select.selectedIndex]?.text || '',
            deadline: inputs[2]?.value || ''
        });
    });
    
    return missions;
}

function collectJournalData() {
    const journalRows = document.querySelectorAll('#journal-body tr');
    const journal = [];
    
    journalRows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        
        journal.push({
            date: inputs[0]?.value || '',
            event: inputs[1]?.value || '',
            player: inputs[2]?.value || ''
        });
    });
    
    return journal;
}

function collectLogisticsData() {
    const logisticsRows = document.querySelectorAll('#logistique-body tr');
    const logistics = [];
    
    logisticsRows.forEach(row => {
        const inputs = row.querySelectorAll('input');
        const selects = row.querySelectorAll('select');
        
        logistics.push({
            type: selects[0]?.options[selects[0].selectedIndex]?.text || '',
            name: inputs[0]?.value || '',
            status: selects[1]?.options[selects[1].selectedIndex]?.text || '',
            location: inputs[1]?.value || ''
        });
    });
    
    return logistics;
}

function collectDangerZonesData() {
    const zoneEntries = document.querySelectorAll('#danger-zone-container .danger-zone-entry');
    const zones = [];
    
    zoneEntries.forEach(zone => {
        const inputs = zone.querySelectorAll('input');
        const select = zone.querySelector('select');
        
        zones.push({
            name: inputs[0]?.value || '',
            danger: select?.options[select.selectedIndex]?.text || '',
            info: inputs[1]?.value || '',
            color: zone.style.borderLeftColor || ''
        });
    });
    
    return zones;
}

// Charger l'√©tat sauvegard√©
function loadStateFromLocalStorage() {
    const savedState = localStorage.getItem('deadhope-state');
    
    if (savedState) {
        const state = JSON.parse(savedState);
        
        // Si le pseudo est diff√©rent, on demande confirmation
        if (state.pseudo && state.pseudo !== window.pseudo) {
            if (!confirm(`Donn√©es sauvegard√©es trouv√©es pour "${state.pseudo}". Voulez-vous charger ces donn√©es ?`)) {
                return; // L'utilisateur a refus√© de charger les donn√©es
            }
        }
        
        // Charger toutes les donn√©es
        loadCharactersData(state.characters);
        loadMissionsData(state.missions);
        loadJournalData(state.journal);
        loadLogisticsData(state.logistics);
        loadDangerZonesData(state.dangerZones);
        
        // Restaurer le temps de jeu
        if (state.gameTime) {
            gameMinutes = state.gameTime.gameMinutes;
            countdownMinutes = state.gameTime.countdownMinutes;
            updateGameClock(); // Mettre √† jour l'affichage
            updateCountdown(); // Mettre √† jour le compte √† rebours
        }
        
        console.log("√âtat charg√© avec succ√®s depuis localStorage");
    }
}

// Fonctions pour charger les donn√©es (similaires √† celles pr√©c√©dentes)
function loadCharactersData(characters) {
    if (!characters || !characters.length) return;
    const characterList = document.getElementById('character-list');
    if (!characterList) return;
    
    resetSection('character-list');
    
    characters.forEach((char, index) => {
        if (index > 0 || characterList.children.length === 0) {
            const template = characterList.children[0] || null;
            if (!template) return;
            
            const clone = template.cloneNode(true);
            const inputs = clone.querySelectorAll('input');
            const textarea = clone.querySelector('textarea');
            
            if (inputs[0]) inputs[0].value = char.name || '';
            if (inputs[1]) inputs[1].value = char.role || '';
            if (textarea) textarea.value = char.notes || '';
            
            characterList.appendChild(clone);
        } else {
            // Premier √©l√©ment
            const inputs = characterList.children[0].querySelectorAll('input');
            const textarea = characterList.children[0].querySelector('textarea');
            
            if (inputs[0]) inputs[0].value = char.name || '';
            if (inputs[1]) inputs[1].value = char.role || '';
            if (textarea) textarea.value = char.notes || '';
        }
    });
}

// Fonctions similaires pour les autres sections...

// Ajoutez ce code √† la fin de votre fichier JavaScript, juste avant la balise de fermeture </script>
  <script>
  const firebaseConfig = {
  apiKey: "AIzaSyDuh0RYk2LHPp_Dc7JCyu-lTOP1kD45xDw",
  authDomain: "deadhope-a1704.firebaseapp.com",
  databaseURL: "https://deadhope-a1704-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "deadhope-a1704",
  storageBucket: "deadhope-a1704.firebasestorage.app",
  messagingSenderId: "1019321338333",
  appId: "1:1019321338333:web:2d2924304d90b0e0f94e34"
};
  
 // Fonctions de chargement des donn√©es
// Ces fonctions sont √©voqu√©es mais pas impl√©ment√©es compl√®tement dans le code d'origine

// Chargement des donn√©es des missions
function loadMissionsData(missions) {
  if (!missions || !missions.length) return;
  const missionBody = document.getElementById('mission-body');
  if (!missionBody) return;
  
  // Vider le tableau
  missionBody.innerHTML = '';
  
  // Recr√©er les entr√©es de mission
  missions.forEach(mission => {
    const row = document.createElement('tr');
    
    // Cr√©er les cellules avec les donn√©es
    row.innerHTML = `
      <td><input type="text" placeholder="Ex: Fouiller maison au nord" value="${mission.objective || ''}"/></td>
      <td><input type="text" placeholder="Nom du joueur" value="${mission.responsible || ''}"/></td>
      <td>
        <select>
          <option ${mission.status && mission.status.includes('En cours') ? 'selected' : ''}>üü° En cours</option>
          <option ${mission.status && mission.status.includes('Fait') ? 'selected' : ''}>‚úÖ Fait</option>
          <option ${mission.status && mission.status.includes('√âchou√©') ? 'selected' : ''}>‚ùå √âchou√©</option>
        </select>
      </td>
      <td><input type="date" value="${mission.deadline || ''}"/></td>
      <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
    `;
    
    missionBody.appendChild(row);
  });
}

// Chargement des donn√©es du journal
function loadJournalData(journal) {
  if (!journal || !journal.length) return;
  const journalBody = document.getElementById('journal-body');
  if (!journalBody) return;
  
  // Vider le tableau
  journalBody.innerHTML = '';
  
  // Recr√©er les entr√©es de journal
  journal.forEach(entry => {
    const row = document.createElement('tr');
    
    // Cr√©er les cellules avec les donn√©es
    row.innerHTML = `
      <td><input type="date" value="${entry.date || ''}"/></td>
      <td><input type="text" placeholder="Description" value="${entry.event || ''}"/></td>
      <td><input type="text" placeholder="Nom du joueur" value="${entry.player || ''}"/></td>
      <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
    `;
    
    journalBody.appendChild(row);
  });
}

// Chargement des donn√©es de logistique
function loadLogisticsData(logistics) {
  if (!logistics || !logistics.length) return;
  const logistiqueBody = document.getElementById('logistique-body');
  if (!logistiqueBody) return;
  
  // Vider le tableau
  logistiqueBody.innerHTML = '';
  
  // Recr√©er les entr√©es de logistique
  logistics.forEach(item => {
    const row = document.createElement('tr');
    
    // D√©finir la couleur de fond selon l'√©tat
    if (item.status && item.status.includes('‚ùå')) {
      row.style.backgroundColor = "rgba(74, 28, 28, 0.4)";
    } else if (item.status && item.status.includes('‚ö†Ô∏è')) {
      row.style.backgroundColor = "rgba(74, 60, 28, 0.4)";
    }
    
    // Cr√©er les cellules avec les donn√©es
    row.innerHTML = `
      <td>
        <select>
          <option ${item.type && item.type.includes('Arme') ? 'selected' : ''}>üî´ Arme</option>
          <option ${item.type && item.type.includes('V√©hicule') ? 'selected' : ''}>üöó V√©hicule</option>
          <option ${item.type && item.type.includes('Outil') ? 'selected' : ''}>üß∞ Outil</option>
          <option ${item.type && item.type.includes('Soins') ? 'selected' : ''}>ü©π Soins</option>
          <option ${item.type && item.type.includes('√âlectronique') ? 'selected' : ''}>üìª √âlectronique</option>
        </select>
      </td>
      <td><input type="text" placeholder="Nom ou mod√®le" value="${item.name || ''}"/></td>
      <td>
        <select onchange="checkEtat(this)">
          <option ${item.status && item.status.includes('Fonctionnel') ? 'selected' : ''}>‚úÖ Fonctionnel</option>
          <option ${item.status && item.status.includes('Endommag√©') ? 'selected' : ''}>‚ö†Ô∏è Endommag√©</option>
          <option ${item.status && item.status.includes('Hors service') ? 'selected' : ''}>‚ùå Hors service</option>
        </select>
      </td>
      <td><input type="text" placeholder="O√π ? ou Avec qui ?" value="${item.location || ''}"/></td>
      <td><button onclick="this.closest('tr').remove()">üóëÔ∏è</button></td>
    `;
    
    logistiqueBody.appendChild(row);
  });
}

// Chargement des donn√©es des zones dangereuses
function loadDangerZonesData(zones) {
  if (!zones || !zones.length) return;
  const zoneContainer = document.getElementById('danger-zone-container');
  if (!zoneContainer) return;
  
  // Vider le conteneur
  zoneContainer.innerHTML = '';
  
  // Recr√©er les entr√©es de zones dangereuses
  zones.forEach(zone => {
    const div = document.createElement('div');
    div.className = 'danger-zone-entry';
    
    // D√©finir la couleur de la bordure en fonction du niveau de danger
    if (zone.danger && zone.danger.includes('Extr√™me')) {
      div.style.borderLeft = '4px solid #e74c3c';
    } else if (zone.danger && zone.danger.includes('√âlev√©')) {
      div.style.borderLeft = '4px solid #f39c12';
    } else if (zone.danger && zone.danger.includes('Mod√©r√©')) {
      div.style.borderLeft = '4px solid #f1c40f';
    } else if (zone.danger && zone.danger.includes('Faible')) {
      div.style.borderLeft = '4px solid #2ecc71';
    } else if (zone.color) {
      div.style.borderLeft = zone.color;
    }
    
    // Cr√©er les √©l√©ments avec les donn√©es
    div.innerHTML = `
      <input type="text" placeholder="Nom du lieu" value="${zone.name || ''}"/>
      <select>
        <option ${zone.danger && zone.danger.includes('Faible') ? 'selected' : ''}>Faible</option>
        <option ${zone.danger && zone.danger.includes('Mod√©r√©') ? 'selected' : ''}>Mod√©r√©</option>
        <option ${zone.danger && zone.danger.includes('√âlev√©') ? 'selected' : ''}>√âlev√©</option>
        <option ${zone.danger && zone.danger.includes('Extr√™me') ? 'selected' : ''}>Extr√™me</option>
      </select>
      <input type="text" placeholder="Informations" value="${zone.info || ''}"/>
      <button onclick="this.parentElement.remove()">üóëÔ∏è</button>
    `;
    
    zoneContainer.appendChild(div);
  });
}

// Fonction d'initialisation Firebase manquante dans le code original
function initFirebaseSync() {
  // Initialiser la synchronisation Firebase
  loadDataFromFirebase();
  setupRealtimeChat();
  setupSyncListeners();
  
  // Synchroniser le temps toutes les minutes
  setInterval(function() {
    isLocalUpdate = true;
    syncDataWithFirebase();
  }, 60000);
  
  // Enregistrer la pr√©sence de l'utilisateur
  registerPresence(window.pseudo);
  
  console.log("Synchronisation Firebase initialis√©e");
  
  // Ajouter un message syst√®me dans le chat
  const chatRef = database.ref('deadhope/chat');
  chatRef.push({
    sender: "Syst√®me",
    message: `${window.pseudo} a rejoint le terminal.`,
    time: new Date().toLocaleTimeString("fr-FR", { hour: '2-digit', minute: '2-digit' }),
    timestamp: Date.now()
  });
}

// Variable globale pour g√©rer les mises √† jour locales vs. distantes
let isLocalUpdate = false;

// Fonction pour g√©rer les modifications des √©tats des items
function checkEtat(select) {
  const row = select.closest("tr");
  const value = select.value;
  
  if (value.includes("‚ùå")) {
    row.style.backgroundColor = "rgba(74, 28, 28, 0.4)";
  } else if (value.includes("‚ö†Ô∏è")) {
    row.style.backgroundColor = "rgba(74, 60, 28, 0.4)";
  } else {
    row.style.backgroundColor = "transparent";
  }
  
  // Synchroniser apr√®s un changement d'√©tat
  setTimeout(function() {
    isLocalUpdate = true;
    syncDataWithFirebase();
  }, 100);
}

// Am√©lioration de la fonction de mise √† jour des zones de danger pour qu'elle mette √† jour la couleur de bordure automatiquement
document.addEventListener('change', function(e) {
  if (e.target.tagName === 'SELECT' && e.target.closest('.danger-zone-entry')) {
    const entry = e.target.closest('.danger-zone-entry');
    const value = e.target.value;
    
    if (value === 'Extr√™me') {
      entry.style.borderLeft = '4px solid #e74c3c';
    } else if (value === '√âlev√©') {
      entry.style.borderLeft = '4px solid #f39c12';
    } else if (value === 'Mod√©r√©') {
      entry.style.borderLeft = '4px solid #f1c40f';
    } else if (value === 'Faible') {
      entry.style.borderLeft = '4px solid #2ecc71';
    }
    
    // Synchroniser apr√®s un changement de niveau de danger
    setTimeout(function() {
      isLocalUpdate = true;
      syncDataWithFirebase();
    }, 100);
  }
});

// Remplacement complet de la fonction setupSyncListeners pour une meilleure gestion des √©v√©nements
function setupSyncListeners() {
  // √âcouter les modifications de Firebase
  deadhopeRef.on('value', snapshot => {
    // Ne pas recharger les donn√©es si c'est nous qui les avons modifi√©es
    if (isLocalUpdate) {
      isLocalUpdate = false;
      return;
    }
    
    const data = snapshot.val();
    if (!data) return;
    
    // Charger silencieusement les donn√©es
    loadCharactersData(data.characters);
    loadMissionsData(data.missions);
    loadJournalData(data.journal);
    loadLogisticsData(data.logistics);
    loadDangerZonesData(data.dangerZones);
    
    // Mettre √† jour le temps
    if (data.gameTime) {
      gameMinutes = data.gameTime.gameMinutes;
      countdownMinutes = data.gameTime.countdownMinutes;
      updateGameClock();
    }
    
    // Afficher une notification discr√®te
    if (data.lastUpdatedBy !== window.pseudo) {
      showSyncNotification(`Mise √† jour par ${data.lastUpdatedBy || "un utilisateur"}`);
    }
  });
  
  // Ajouter un d√©bounce pour les modifications
  let timeoutId = null;
  
  // Observer les modifications sur les inputs et selects
  document.addEventListener('input', function(e) {
    if (timeoutId) clearTimeout(timeoutId);
    
    timeoutId = setTimeout(function() {
      isLocalUpdate = true;
      syncDataWithFirebase();
    }, 1000); // R√©duit √† 1 seconde pour une r√©activit√© am√©lior√©e
  });
  
  // Observer les changements de select
  document.addEventListener('change', function(e) {
    if (e.target.tagName === 'SELECT') {
      if (timeoutId) clearTimeout(timeoutId);
      
      timeoutId = setTimeout(function() {
        isLocalUpdate = true;
        syncDataWithFirebase();
      }, 500); // Plus rapide pour les s√©lections
    }
  });
  
  // √âcouter les clics sur les boutons d'ajout/suppression
  document.addEventListener('click', function(e) {
    if (e.target.tagName === 'BUTTON' && 
        (e.target.textContent.includes('Ajouter') || 
         e.target.textContent.includes('Supprimer') || 
         e.target.textContent.includes('üóëÔ∏è'))) {
      
      setTimeout(function() {
        isLocalUpdate = true;
        syncDataWithFirebase();
      }, 300);
    }
  });
}

// Fonction pour notifier automatiquement quand un utilisateur se connecte
document.addEventListener('DOMContentLoaded', function() {
  // √âcouter les pr√©sences des utilisateurs
  const presenceRef = database.ref("presence");
  presenceRef.on("value", (snapshot) => {
    const users = snapshot.val() || {};
    const userList = Object.keys(users);
    const container = document.querySelector("#connected-users span");
    if (container) {
      container.textContent = userList.length > 0 ? userList.join(", ") : "Aucun";
    }
  });
});
</script>
</body>
</html>
